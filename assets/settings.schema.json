{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["browser", "mitm", "server", "ot", "model_config"],
  "properties": {
    "log_level": {
      "type": "string",
      "enum": ["TRACE", "DEBUG", "INFO", "WARNING", "ERROR"],
      "default": "INFO",
      "description": "Logging level."
    },
    "locale": {
      "type": "string",
      "enum": ["zh-CN", "zh-TW", "en-US", "ja-JP"],
      "default": "en-US",
      "description": "UI Language locale."
    },
    "browser": {
      "type": "object",
      "description": "Browser configuration.",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable internal browser automation (Playwright)."
        },
        "platform": {
          "type": "string",
          "enum": ["majsoul", "tenhou"],
          "default": "majsoul",
          "description": "The target mahjong platform."
        },
        "url": {
          "type": "string",
          "default": "",
          "description": "Game URL override.",
          "format": "uri"
        },
        "window_size": {
          "type": "string",
          "default": "",
          "description": "Initial window size (e.g., '1920,1080'). Leave empty for maximized."
        }
      },
      "required": ["enabled", "platform", "url", "window_size"],
      "additionalProperties": false
    },
    "mitm": {
      "type": "object",
      "description": "MITM proxy configuration.",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false,
          "description": "Enable MITM proxy."
        },
        "platform": {
          "type": "string",
          "enum": ["auto", "majsoul", "tenhou", "amatsuki", "riichi_city"],
          "default": "auto",
          "description": "The target mahjong platform."
        },
        "host": {
          "type": "string",
          "default": "127.0.0.1",
          "description": "MITM proxy listening host."
        },
        "port": {
          "type": "integer",
          "default": 6789,
          "description": "MITM proxy listening port."
        },
        "upstream": {
          "type": "string",
          "default": "",
          "description": "Upstream proxy URL (e.g. http://127.0.0.1:7890)."
        }
      },
      "required": ["enabled", "platform", "host", "port", "upstream"],
      "additionalProperties": false
    },
    "server": {
      "type": "object",
      "description": "Data server configuration.",
      "properties": {
        "host": {
          "type": "string",
          "default": "0.0.0.0",
          "description": "Server listening host."
        },
        "port": {
          "type": "integer",
          "default": 8765,
          "description": "Server listening port."
        }
      },
      "required": ["host", "port"],
      "additionalProperties": false
    },
    "ot": {
      "description": "Online learning/teacher configuration.",
      "type": "object",
      "properties": {
        "online": {
          "type": "boolean",
          "description": "Whether to use the online service.",
          "default": false
        },
        "server": {
          "type": "string",
          "description": "The server URL for the online service.",
          "format": "uri"
        },
        "api_key": {
          "type": "string",
          "description": "The API key for the online service."
        }
      },
      "required": ["online"],
      "if": {
        "properties": {
          "online": {
            "const": true
          }
        }
      },
      "then": {
        "required": ["server", "api_key"]
      },
      "additionalProperties": false
    },
    "model_config": {
      "type": "object",
      "description": "AI model configuration.",
      "properties": {
        "device": {
          "type": "string",
          "enum": ["cpu", "cuda", "auto"],
          "default": "auto",
          "description": "Computing device selection."
        },
        "temperature": {
          "type": "number",
          "default": 0.3,
          "description": "Softmax temperature for model confidence normalization."
        },
        "enable_amp": {
          "type": "boolean",
          "default": false,
          "description": "Enable automatic mixed precision for inference."
        },
        "enable_quick_eval": {
          "type": "boolean",
          "default": false,
          "description": "Enable quick evaluation for the model."
        },
        "rule_based_agari_guard": {
          "type": "boolean",
          "default": true,
          "description": "Enable rule-based check to prevent missing wins."
        }
      },
      "required": [
        "device",
        "temperature",
        "enable_amp",
        "enable_quick_eval",
        "rule_based_agari_guard"
      ],
      "additionalProperties": false
    }
  },
  "description": "Settings for the application.",
  "additionalProperties": false
}
